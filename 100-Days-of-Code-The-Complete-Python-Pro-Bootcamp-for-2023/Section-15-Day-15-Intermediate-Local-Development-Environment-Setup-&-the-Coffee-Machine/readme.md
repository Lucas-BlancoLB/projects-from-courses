Reduce the lines and improve the code
